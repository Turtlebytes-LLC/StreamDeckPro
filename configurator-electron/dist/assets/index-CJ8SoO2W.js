(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const r of l.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function s(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(o){if(o.ep)return;o.ep=!0;const l=s(o);fetch(o.href,l)}})();let a={},I=null,C=[];document.addEventListener("DOMContentLoaded",async()=>{a=await window.api.getDirectories(),K(),j(),$(),G(),await f(),await x(),await p(),d("Ready","success")});function K(){document.querySelectorAll(".tab").forEach(t=>{t.addEventListener("click",()=>E(t.dataset.tab))})}function E(t){document.querySelectorAll(".tab").forEach(e=>{e.dataset.tab===t?(e.classList.remove("tab-inactive"),e.classList.add("tab-active")):(e.classList.remove("tab-active"),e.classList.add("tab-inactive"))}),document.querySelectorAll(".tab-content").forEach(e=>{e.classList.add("hidden")}),document.getElementById(t+"-tab").classList.remove("hidden")}function j(){document.addEventListener("keydown",t=>{(t.ctrlKey&&t.key==="w"||t.ctrlKey&&t.key==="q"||t.key==="Escape")&&(t.preventDefault(),window.close()),t.ctrlKey&&t.key==="1"&&E("buttons"),t.ctrlKey&&t.key==="2"&&E("dials"),t.ctrlKey&&t.key==="3"&&E("touchscreen"),t.ctrlKey&&t.key==="e"&&(t.preventDefault(),D()),t.ctrlKey&&t.key==="i"&&(t.preventDefault(),A())})}function $(){document.getElementById("export-btn").addEventListener("click",D),document.getElementById("import-btn").addEventListener("click",A),document.getElementById("autostart-btn").addEventListener("click",q),T()}async function T(){const t=await window.api.checkAutostart(),e=document.getElementById("autostart-btn");t.success&&t.enabled?(e.textContent="‚úì Auto-start ON",e.className="btn-success text-sm"):(e.textContent="‚öôÔ∏è Auto-start OFF",e.className="btn-purple text-sm")}async function q(){const t=await window.api.checkAutostart(),e=!(t.success&&t.enabled);await window.api.toggleAutostart(e),await T(),d(e?"Auto-start enabled":"Auto-start disabled","success")}async function D(){const t=await window.api.browseSaveFile({title:"Export Configuration",defaultPath:"streamdeck-config.tar.gz",filters:[{name:"Tar Archive",extensions:["tar.gz"]}]});if(!t.canceled&&t.filePath){const e=`tar -czf "${t.filePath}" -C "${a.streamdeck}" buttons dials touchscreen`;(await window.api.execCommand(e)).success?d("Configuration exported successfully","success"):d("Export failed","error")}}async function A(){const t=await window.api.browseFile({title:"Import Configuration",filters:[{name:"Tar Archive",extensions:["tar.gz"]}]});if(!t.canceled&&t.filePaths.length>0){const e=`tar -xzf "${t.filePaths[0]}" -C "${a.streamdeck}"`;(await window.api.execCommand(e)).success?(d("Configuration imported - reloading...","success"),await Promise.all([f(),x(),p()]),await window.api.restartDaemon()):d("Import failed","error")}}function d(t,e="info"){const s=document.getElementById("status-text");s.textContent=t,s.className="",e==="success"?s.classList.add("text-green-600"):e==="error"?s.classList.add("text-red-600"):e==="warning"?s.classList.add("text-amber-600"):s.classList.add("text-gray-700")}async function v(t){return await window.api.fileExists(t)}async function g(t){const e=await window.api.readFile(t);return e.success?e.content:null}async function b(t,e){return await window.api.writeFile(t,e)}async function y(t){return await window.api.deleteFile(t)}async function M(t,e){for(const s of[".png",".jpg",".jpeg"]){const n=t+"/"+e+s;if(await v(n))return n}return null}async function k(t){const e=await g(t);if(!e)return"Script configured";const s=e.split(`
`);for(const o of s)if(o.startsWith("# Description:"))return o.replace("# Description:","").trim();const n=s.find(o=>o.trim()&&!o.startsWith("#"));return n?n.substring(0,50)+"...":"Script configured"}async function f(){const t=document.getElementById("buttons-container"),e=t.scrollTop;t.innerHTML="";for(let s=1;s<=8;s++){const n=await O(s);t.appendChild(n)}t.scrollTop=e,document.getElementById("apply-button-fontsize").onclick=async()=>{const s=document.getElementById("button-fontsize-all").value;for(let n=1;n<=8;n++)await b(a.buttons+"/button-"+n+"-fontsize.txt",s);d("Font size "+s+" applied to all buttons","success"),await f()}}async function O(t){const e=document.createElement("div");e.className="card fade-in";const s=a.buttons+"/button-"+t+".sh",n=await M(a.buttons,"button-"+t),o=a.buttons+"/button-"+t+".txt",l=a.buttons+"/button-"+t+"-position.txt",r=a.buttons+"/button-"+t+"-fontsize.txt",u=await v(s),m=await g(o),i=await g(l)||"bottom",h=await g(r)||"24";let c='<div class="card-header bg-gradient-to-r from-blue-500 to-indigo-500">Button '+t+'</div><div class="space-y-4">';if(c+='<div class="space-y-2">',u){const w=await k(s);c+='<div class="text-green-600 text-sm font-medium">‚ñ∂ '+w+"</div>"}else c+='<div class="text-gray-500 text-sm">‚óã No script assigned</div>';if(n){const w=await window.api.readImageBase64(n);if(w.success){const S=n.split("/").pop();c+='<div class="flex items-center gap-2"><img src="'+w.data+'" class="w-8 h-8 border-2 border-gray-200 rounded"><span class="text-gray-700 text-sm">üñº '+S+"</span></div>"}}return m&&(c+='<div class="text-gray-700 text-sm">üè∑ "'+m+'"</div>'),c+="</div>",c+='<div class="border-t border-gray-200"></div>',c+='<div><span class="label">Script</span><div class="flex flex-wrap gap-2 mt-2">',c+='<button class="btn-primary text-sm" onclick="browseScript('+t+')">üìÅ Browse</button>',c+='<button class="btn-success text-sm" onclick="browseExamples('+t+`, 'button')">üìö Examples</button>`,c+='<button class="btn-purple text-sm" onclick="recordAction('+t+`, 'button')">‚å®Ô∏è Record</button>`,u&&(c+=`<button class="btn-warning text-sm" onclick="editScript('`+s+`')">‚úèÔ∏è Edit</button>`,c+='<button class="btn-danger text-sm" onclick="removeScript('+t+')">üóë Remove</button>'),c+="</div></div>",c+='<div><span class="label">Image</span><div class="flex flex-wrap gap-2 mt-2">',c+='<button class="btn-primary text-sm" onclick="browseImage('+t+`, 'button')">üñº Browse</button>`,c+='<button class="btn-purple text-sm" onclick="selectIcon('+t+`, 'button')">üé® Icons</button>`,n&&(c+='<button class="btn-danger text-sm" onclick="removeImage('+t+`, 'button')">üóë Remove</button>`),c+="</div></div>",c+='<div><span class="label">Label</span>',c+='<div class="flex flex-wrap gap-2 mt-2 items-center">',c+='<input type="text" id="button-'+t+'-label" class="input flex-1" value="'+(m||"")+'" placeholder="Enter label...">',c+='<button class="btn-success text-sm" onclick="setLabel('+t+`, 'button')">‚úì Set</button>`,c+="</div>",c+='<div class="flex flex-wrap gap-2 mt-2 items-center">',c+='<span class="text-gray-700 text-sm font-medium">Position:</span>',c+='<select id="button-'+t+'-position" class="input w-32">',c+='<option value="top"'+(i==="top"?" selected":"")+">Top</option>",c+='<option value="middle"'+(i==="middle"?" selected":"")+">Middle</option>",c+='<option value="bottom"'+(i==="bottom"?" selected":"")+">Bottom</option>",c+="</select>",c+='<span class="text-gray-700 text-sm font-medium ml-4">Font Size:</span>',c+='<input type="number" id="button-'+t+'-fontsize" class="input w-20" value="'+h+'" min="10" max="60">',c+='<button class="btn-primary text-sm" onclick="setFontSize('+t+`, 'button')">Apply</button>`,c+="</div></div>",c+="</div>",e.innerHTML=c,e}async function x(){const t=document.getElementById("dials-container"),e=t.scrollTop;t.innerHTML="";for(let s=1;s<=4;s++){const n=await U(s);t.appendChild(n)}t.scrollTop=e}async function U(t){const e=document.createElement("div");e.className="card fade-in";const s=[{key:"cw",name:"‚Üª Clockwise",icon:"üîµ"},{key:"ccw",name:"‚Ü∫ Counter-Clockwise",icon:"üü¢"},{key:"press",name:"‚¨á Press",icon:"üü°"},{key:"longpress",name:"‚è± Long Press",icon:"üî¥"}];let n='<div class="card-header bg-gradient-to-r from-amber-500 to-orange-500">Dial '+t+'</div><div class="space-y-3">';for(const o of s){const l=a.dials+"/dial-"+t+"-"+o.key+".sh",r=await v(l);if(n+='<div class="action-row">',n+='<div class="action-label">'+o.icon+" "+o.name+"</div>",r){const u=await k(l);n+='<div class="action-status action-status-configured">'+u+"</div>"}else n+='<div class="action-status">Not configured</div>';n+='<button class="btn-secondary text-sm" onclick="browseDialScript('+t+", '"+o.key+`')">Browse</button>`,n+='<button class="btn-success text-sm" onclick="browseDialExamples('+t+", '"+o.key+`')">Examples</button>`,n+='<button class="btn-purple text-sm" onclick="recordDialAction('+t+", '"+o.key+`')">Record</button>`,r&&(n+=`<button class="btn-warning text-sm" onclick="editScript('`+l+`')">Edit</button>`,n+='<button class="btn-danger text-sm" onclick="removeDialScript('+t+", '"+o.key+`')">Remove</button>`),n+="</div>"}return n+="</div>",e.innerHTML=n,e}async function p(){const t=document.getElementById("touchscreen-container"),e=t.scrollTop;t.innerHTML="";for(let n=1;n<=4;n++){const o=await _(n);t.appendChild(o)}const s=await W();t.appendChild(s),t.scrollTop=e,document.getElementById("apply-touch-fontsize").onclick=async()=>{const n=document.getElementById("touch-fontsize-all").value;for(let o=1;o<=4;o++)await b(a.touch+"/touch-"+o+"-fontsize.txt",n);d("Font size "+n+" applied to all zones","success"),await p()}}async function _(t){const e=document.createElement("div");e.className="card fade-in";const s=await M(a.touch,"touch-"+t),n=a.touch+"/touch-"+t+".txt",o=a.touch+"/touch-"+t+"-position.txt",l=a.touch+"/touch-"+t+"-fontsize.txt",r=await g(n),u=await g(o)||"middle",m=await g(l)||"28";let i='<div class="card-header bg-gradient-to-r from-purple-500 to-pink-500">Touch Zone '+t+'</div><div class="space-y-4">';if(i+='<div class="space-y-2">',s){const c=await window.api.readImageBase64(s);if(c.success){const w=s.split("/").pop();i+='<div class="flex items-center gap-2"><img src="'+c.data+'" class="w-8 h-8 border-2 border-gray-200 rounded"><span class="text-gray-700 text-sm">üñº '+w+"</span></div>"}}r&&(i+='<div class="text-gray-700 text-sm">üè∑ "'+r+'"</div>'),i+="</div>",i+='<div><span class="label">Image</span><div class="flex flex-wrap gap-2 mt-2">',i+='<button class="btn-primary text-sm" onclick="browseImage('+t+`, 'touch')">üñº Browse</button>`,i+='<button class="btn-purple text-sm" onclick="selectIcon('+t+`, 'touch')">üé® Icons</button>`,s&&(i+='<button class="btn-danger text-sm" onclick="removeImage('+t+`, 'touch')">üóë Remove</button>`),i+="</div></div>",i+='<div><span class="label">Label</span>',i+='<div class="flex flex-wrap gap-2 mt-2 items-center">',i+='<input type="text" id="touch-'+t+'-label" class="input flex-1" value="'+(r||"")+'" placeholder="Enter label...">',i+='<button class="btn-success text-sm" onclick="setLabel('+t+`, 'touch')">‚úì Set</button>`,i+="</div>",i+='<div class="flex flex-wrap gap-2 mt-2 items-center">',i+='<span class="text-gray-700 text-sm font-medium">Position:</span>',i+='<select id="touch-'+t+'-position" class="input w-32">',i+='<option value="top"'+(u==="top"?" selected":"")+">Top</option>",i+='<option value="middle"'+(u==="middle"?" selected":"")+">Middle</option>",i+='<option value="bottom"'+(u==="bottom"?" selected":"")+">Bottom</option>",i+="</select>",i+='<span class="text-gray-700 text-sm font-medium ml-4">Font Size:</span>',i+='<input type="number" id="touch-'+t+'-fontsize" class="input w-20" value="'+m+'" min="10" max="60">',i+='<button class="btn-primary text-sm" onclick="setFontSize('+t+`, 'touch')">Apply</button>`,i+="</div></div>",i+='<div class="border-t border-gray-200"></div>';const h=[{suffix:"",name:"üëÜ Tap"},{suffix:"-longpress",name:"‚è± Long Press"},{suffix:"-swipe-up",name:"‚¨ÜÔ∏è Swipe Up"},{suffix:"-swipe-down",name:"‚¨áÔ∏è Swipe Down"},{suffix:"-swipe-left",name:"‚¨ÖÔ∏è Swipe Left"},{suffix:"-swipe-right",name:"‚û°Ô∏è Swipe Right"}];for(const c of h){const w=a.touch+"/touch-"+t+c.suffix+".sh",S=await v(w);if(i+='<div class="action-row">',i+='<div class="action-label">'+c.name+"</div>",S){const z=await k(w);i+='<div class="action-status action-status-configured">'+z+"</div>"}else i+='<div class="action-status">Not configured</div>';i+='<button class="btn-secondary text-sm" onclick="browseTouchScript('+t+", '"+c.suffix+`')">Browse</button>`,i+='<button class="btn-success text-sm" onclick="browseTouchExamples('+t+", '"+c.suffix+`')">Examples</button>`,i+='<button class="btn-purple text-sm" onclick="recordTouchAction('+t+", '"+c.suffix+`')">Record</button>`,S&&(i+=`<button class="btn-warning text-sm" onclick="editScript('`+w+`')">Edit</button>`,i+='<button class="btn-danger text-sm" onclick="removeTouchScript('+t+", '"+c.suffix+`')">Remove</button>`),i+="</div>"}return i+="</div>",e.innerHTML=i,e}async function W(){const t=document.createElement("div");t.className="card fade-in";let e='<div class="card-header bg-gradient-to-r from-pink-500 to-rose-500">Long Swipes (across >2 zones)</div><div class="space-y-3">';for(const s of["left","right"]){const n=a.touch+"/longswipe-"+s+".sh",o=await v(n),l=s==="left"?"‚¨ÖÔ∏è":"‚û°Ô∏è",r=s.charAt(0).toUpperCase()+s.slice(1);if(e+='<div class="action-row">',e+='<div class="action-label">'+l+" Long Swipe "+r+"</div>",o){const u=await k(n);e+='<div class="action-status action-status-configured">'+u+"</div>"}else e+='<div class="action-status">Not configured</div>';e+=`<button class="btn-secondary text-sm" onclick="browseLongSwipeScript('`+s+`')">Browse</button>`,e+=`<button class="btn-success text-sm" onclick="browseLongSwipeExamples('`+s+`')">Examples</button>`,e+=`<button class="btn-purple text-sm" onclick="recordLongSwipeAction('`+s+`')">Record</button>`,o&&(e+=`<button class="btn-warning text-sm" onclick="editScript('`+n+`')">Edit</button>`,e+=`<button class="btn-danger text-sm" onclick="removeLongSwipeScript('`+s+`')">Remove</button>`),e+="</div>"}return e+="</div>",t.innerHTML=e,t}window.browseScript=async t=>{const e=await window.api.browseFile({title:"Select Script File",defaultPath:a.examples,filters:[{name:"Shell Scripts",extensions:["sh"]}]});if(!e.canceled&&e.filePaths.length>0){const s=a.buttons+"/button-"+t+".sh";await window.api.copyFile(e.filePaths[0],s),await window.api.makeExecutable(s),d("Script copied","success"),await f()}};window.removeScript=async t=>{const e=a.buttons+"/button-"+t+".sh";await y(e),d("Script removed","success"),await f()};window.browseImage=async(t,e)=>{const s=await window.api.browseFile({title:"Select Image File",filters:[{name:"Images",extensions:["png","jpg","jpeg"]}]});if(!s.canceled&&s.filePaths.length>0){const n=e==="button"?a.buttons:a.touch,o=e==="button"?"button-"+t:"touch-"+t,l=s.filePaths[0].split(".").pop(),r=n+"/"+o+"."+l;await window.api.copyFile(s.filePaths[0],r),d("Image set","success"),e==="button"?await f():await p()}};window.removeImage=async(t,e)=>{const s=e==="button"?a.buttons:a.touch,n=e==="button"?"button-"+t:"touch-"+t;for(const o of[".png",".jpg",".jpeg"]){const l=s+"/"+n+o;await v(l)&&await y(l)}d("Image removed","success"),e==="button"?await f():await p()};window.setLabel=async(t,e)=>{const s=e==="button"?"button":"touch",n=e==="button"?a.buttons:a.touch,o=document.getElementById(s+"-"+t+"-label").value,l=n+"/"+s+"-"+t+".txt",r=n+"/"+s+"-"+t+"-position.txt";o.trim()?await b(l,o.trim()):await y(l);const u=document.getElementById(s+"-"+t+"-position").value;await b(r,u),d("Label and position set","success")};window.setFontSize=async(t,e)=>{const s=e==="button"?"button":"touch",n=e==="button"?a.buttons:a.touch,o=document.getElementById(s+"-"+t+"-fontsize").value,l=n+"/"+s+"-"+t+"-fontsize.txt";await b(l,o),d("Font size set","success")};window.selectIcon=(t,e)=>{I={num:t,type:e},X()};window.editScript=async t=>{await window.api.execCommand('xdg-open "'+t+'"')};window.browseDialScript=async(t,e)=>{const s=await window.api.browseFile({title:"Select Script File",defaultPath:a.examples,filters:[{name:"Shell Scripts",extensions:["sh"]}]});if(!s.canceled&&s.filePaths.length>0){const n=a.dials+"/dial-"+t+"-"+e+".sh";await window.api.copyFile(s.filePaths[0],n),await window.api.makeExecutable(n),d("Script copied","success"),await x()}};window.removeDialScript=async(t,e)=>{const s=a.dials+"/dial-"+t+"-"+e+".sh";await y(s),d("Script removed","success"),await x()};window.browseTouchScript=async(t,e)=>{const s=await window.api.browseFile({title:"Select Script File",defaultPath:a.examples,filters:[{name:"Shell Scripts",extensions:["sh"]}]});if(!s.canceled&&s.filePaths.length>0){const n=a.touch+"/touch-"+t+e+".sh";await window.api.copyFile(s.filePaths[0],n),await window.api.makeExecutable(n),d("Script copied","success"),await p()}};window.removeTouchScript=async(t,e)=>{const s=a.touch+"/touch-"+t+e+".sh";await y(s),d("Script removed","success"),await p()};window.browseLongSwipeScript=async t=>{const e=await window.api.browseFile({title:"Select Script File",defaultPath:a.examples,filters:[{name:"Shell Scripts",extensions:["sh"]}]});if(!e.canceled&&e.filePaths.length>0){const s=a.touch+"/longswipe-"+t+".sh";await window.api.copyFile(e.filePaths[0],s),await window.api.makeExecutable(s),d("Script copied","success"),await p()}};window.removeLongSwipeScript=async t=>{const e=a.touch+"/longswipe-"+t+".sh";await y(e),d("Script removed","success"),await p()};window.browseExamples=async(t,e)=>{const s=await window.api.browseFile({title:"Select Example Script",defaultPath:a.examples,filters:[{name:"Shell Scripts",extensions:["sh"]}]});if(!s.canceled&&s.filePaths.length>0){const n=a.buttons+"/button-"+t+".sh";await window.api.copyFile(s.filePaths[0],n),await window.api.makeExecutable(n),d("Example script copied","success"),await f()}};window.browseDialExamples=async(t,e)=>{const s=await window.api.browseFile({title:"Select Example Script",defaultPath:a.examples,filters:[{name:"Shell Scripts",extensions:["sh"]}]});if(!s.canceled&&s.filePaths.length>0){const n=a.dials+"/dial-"+t+"-"+e+".sh";await window.api.copyFile(s.filePaths[0],n),await window.api.makeExecutable(n),d("Example script copied","success"),await x()}};window.browseTouchExamples=async(t,e)=>{const s=await window.api.browseFile({title:"Select Example Script",defaultPath:a.examples,filters:[{name:"Shell Scripts",extensions:["sh"]}]});if(!s.canceled&&s.filePaths.length>0){const n=a.touch+"/touch-"+t+e+".sh";await window.api.copyFile(s.filePaths[0],n),await window.api.makeExecutable(n),d("Example script copied","success"),await p()}};window.browseLongSwipeExamples=async t=>{const e=await window.api.browseFile({title:"Select Example Script",defaultPath:a.examples,filters:[{name:"Shell Scripts",extensions:["sh"]}]});if(!e.canceled&&e.filePaths.length>0){const s=a.touch+"/longswipe-"+t+".sh";await window.api.copyFile(e.filePaths[0],s),await window.api.makeExecutable(s),d("Example script copied","success"),await p()}};window.recordAction=async(t,e)=>{const s=L("Button "+t);document.body.appendChild(s);const n=await P(s);if(n.length>0){const o=F(n),l=a.buttons+"/button-"+t+".sh";await b(l,o),await window.api.makeExecutable(l),d("Recorded script saved","success"),await f()}document.body.removeChild(s)};window.recordDialAction=async(t,e)=>{const s={cw:"Clockwise",ccw:"Counter-Clockwise",press:"Press",longpress:"Long Press"},n=L("Dial "+t+" - "+s[e]);document.body.appendChild(n);const o=await P(n);if(o.length>0){const l=F(o),r=a.dials+"/dial-"+t+"-"+e+".sh";await b(r,l),await window.api.makeExecutable(r),d("Recorded script saved","success"),await x()}document.body.removeChild(n)};window.recordTouchAction=async(t,e)=>{const s={"":"Tap","-longpress":"Long Press","-swipe-up":"Swipe Up","-swipe-down":"Swipe Down","-swipe-left":"Swipe Left","-swipe-right":"Swipe Right"},n=L("Touch Zone "+t+" - "+s[e]);document.body.appendChild(n);const o=await P(n);if(o.length>0){const l=F(o),r=a.touch+"/touch-"+t+e+".sh";await b(r,l),await window.api.makeExecutable(r),d("Recorded script saved","success"),await p()}document.body.removeChild(n)};window.recordLongSwipeAction=async t=>{const e=L("Long Swipe "+t.charAt(0).toUpperCase()+t.slice(1));document.body.appendChild(e);const s=await P(e);if(s.length>0){const n=F(s),o=a.touch+"/longswipe-"+t+".sh";await b(o,n),await window.api.makeExecutable(o),d("Recorded script saved","success"),await p()}document.body.removeChild(e)};function L(t){const e=document.createElement("div");return e.className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",e.innerHTML=`
    <div class="bg-white rounded-lg shadow-2xl w-2/3 max-w-2xl p-6">
      <div class="bg-gradient-to-r from-purple-500 to-pink-500 text-white font-bold text-lg px-4 py-3 rounded-lg mb-4">
        ‚å®Ô∏è Record Action - ${t}
      </div>
      <div class="mb-4">
        <p class="text-gray-700 mb-2">Press keyboard keys or click mouse buttons to record. Click "Stop & Save" when done.</p>
        <div class="bg-gray-100 border-2 border-gray-300 rounded p-4 min-h-32 max-h-64 overflow-auto font-mono text-sm">
          <div id="recorded-events" class="text-gray-600">Waiting for input...</div>
        </div>
      </div>
      <div class="flex gap-3 justify-end">
        <button id="record-cancel" class="btn-danger">Cancel</button>
        <button id="record-save" class="btn-success">Stop & Save</button>
      </div>
    </div>
  `,e}function P(t){return new Promise(e=>{const s=[],n=t.querySelector("#recorded-events"),o=r=>{r.preventDefault(),r.stopPropagation();const u=r.key,m=r.code,i=[];r.ctrlKey&&i.push("ctrl"),r.shiftKey&&i.push("shift"),r.altKey&&i.push("alt"),r.metaKey&&i.push("super");const h={type:"key",key:u,code:m,modifiers:i};s.push(h);const c=i.length>0?i.join("+")+"+":"",w=u===" "?"Space":u;n.innerHTML+=`<div class="text-blue-600">Key: ${c}${w}</div>`,n.scrollTop=n.scrollHeight},l=r=>{if(r.target.closest("#record-cancel")||r.target.closest("#record-save"))return;r.preventDefault();const u=r.button===0?"left":r.button===1?"middle":"right";s.push({type:"mouse",button:u}),n.innerHTML+=`<div class="text-green-600">Mouse: ${u} click</div>`,n.scrollTop=n.scrollHeight};document.addEventListener("keydown",o),document.addEventListener("mousedown",l),t.querySelector("#record-save").onclick=()=>{document.removeEventListener("keydown",o),document.removeEventListener("mousedown",l),e(s)},t.querySelector("#record-cancel").onclick=()=>{document.removeEventListener("keydown",o),document.removeEventListener("mousedown",l),e([])}})}function Z(t,e){const s={" ":"space",Enter:"Return",Escape:"Escape",Tab:"Tab",Backspace:"BackSpace",Delete:"Delete",Insert:"Insert",Home:"Home",End:"End",PageUp:"Page_Up",PageDown:"Page_Down",ArrowUp:"Up",ArrowDown:"Down",ArrowLeft:"Left",ArrowRight:"Right",PrintScreen:"Print",ScrollLock:"Scroll_Lock",Pause:"Pause",CapsLock:"Caps_Lock",NumLock:"Num_Lock",ContextMenu:"Menu",F1:"F1",F2:"F2",F3:"F3",F4:"F4",F5:"F5",F6:"F6",F7:"F7",F8:"F8",F9:"F9",F10:"F10",F11:"F11",F12:"F12"};return s[t]?s[t]:t.length===1?t.toLowerCase():t}function F(t){let e=`#!/bin/bash
`;e+=`# Description: Recorded input sequence
`,e+=`# Generated by Stream Deck Configurator

`;for(const s of t)if(s.type==="key"){const n=Z(s.key,s.code),o=s.modifiers.join("+"),l=o?o+"+"+n:n;e+=`xdotool key "${l}"
`}else if(s.type==="mouse"){const n=s.button==="left"?1:s.button==="middle"?2:3;e+=`xdotool click ${n}
`}return e}function G(){document.getElementById("close-icon-modal").addEventListener("click",R),document.getElementById("icon-category").addEventListener("change",B),document.getElementById("icon-color").addEventListener("change",B),document.getElementById("icon-search").addEventListener("input",H)}async function X(){document.getElementById("icon-modal").classList.remove("hidden"),document.getElementById("icon-modal").classList.add("flex"),await B()}function R(){document.getElementById("icon-modal").classList.add("hidden"),document.getElementById("icon-modal").classList.remove("flex")}async function B(){const t=document.getElementById("icon-category").value,e=document.getElementById("icon-color").value,s=a.icons+"/"+t+"/"+e,n=await window.api.listDirectory(s);n.success?(C=n.files.filter(o=>o.endsWith(".png")),H()):(C=[],d("Icons not found in this category/color","warning"),document.getElementById("icon-grid").innerHTML='<div class="col-span-6 text-center text-gray-600 py-8">No icons found</div>')}function H(){const t=document.getElementById("icon-search").value.toLowerCase(),e=C.filter(o=>o.toLowerCase().includes(t)),s=document.getElementById("icon-grid");s.innerHTML="";const n=Math.min(e.length,30);for(let o=0;o<n;o++){const l=e[o],r=document.getElementById("icon-category").value,u=document.getElementById("icon-color").value,m=a.icons+"/"+r+"/"+u+"/"+l,i=document.createElement("div");i.className="icon-item",i.title=l,i.onclick=()=>J(m),window.api.readImageBase64(m).then(h=>{if(h.success){const c=document.createElement("img");c.src=h.data,c.className="w-12 h-12",i.appendChild(c)}}),s.appendChild(i)}n===0?s.innerHTML='<div class="col-span-6 text-center text-gray-600 py-8">No matching icons</div>':e.length>30&&(s.innerHTML+='<div class="col-span-6 text-center text-sm text-gray-600 py-4">Showing first 30 of '+e.length+" icons</div>")}async function J(t){if(!I)return;const{num:e,type:s}=I,n=s==="button"?a.buttons:a.touch,o=s==="button"?"button-"+e:"touch-"+e,l=n+"/"+o+".png";await window.api.copyFile(t,l),d("Icon set","success"),R(),s==="button"?await f():await p()}
